# -*- coding: utf-8 -*-

<%namespace name="pagination" file="/components/pagination.html"/>
<%namespace name="modals" file="/components/modals.html"/>
<%namespace name="forms" file="/components/forms.html"/>
<%


for cve in cvePaginator.list:
  url = '<a href="{0}" target="_blank">{1}</a>'.format(cveUrl+ cve.cve_number,cve.cve_number)
  setattr(cve, 'idLink', url)

found = False
for x in range(len(cvePaginator.lables)):
  for key,value in cvePaginator.lables[x].iteritems():
    if key == 'cve_number':
      hash = dict()
      hash['idLink'] = value
      cvePaginator.lables[x] =hash
      found = True
      break
  if found:
    break
  

    

%>
<div class="btn-group">
  <a href="#addCVEModal" role="button" class="btn" data-toggle="modal">Add CVE</a>
</div>
<br/><br/>
<%call expr="pagination.pagination('cvesTable',cvePaginator,hasSearch=True)"/> 

<!-- RTcves -->
<%call expr="forms.genericModalForm(modalID='addCVEModal',url='/events/event/cves/modifyCVE',refreshUrl='/events/event/cves/cves/{0}'.format(eventID),refreshContainer='eventTabs{0}TabContent'.format(eventID))">
<input type="hidden" name="action" value="insert">
<%call expr="modals.genericModal('addCVEModal', 'Add CVE', '/events/event/cves/addCVE/{0}'.format(eventID))">
<input class="btn btn-primary" type="submit" value="Save changes"/>
</%call>
</%call>
