# -*- coding: utf-8 -*-

<%namespace name="modals" file="/components/modals.html"/>
<%namespace name="forms" file="/components/forms.html"/>



<script type="text/javascript">
function loadObject(eventID,objectID){
    $("#objectRight").load("/events/event/objects/detail/"+eventID+"/"+objectID, "", 
           function (responseText, textStatus, XMLHttpRequest) {
              if(textStatus == 'error') {
                  $('#objectRight').html('<div class="alert alert-error">There was an error making the AJAX request</div>'+responseText);
              }
        });
}
</script>

<% 
foundObject=False 
fistObjectID=0
%>

<div class="btn-group">
  <a href="#addObjectModal" role="button" class="btn" data-toggle="modal">Add new Object</a>
  <a href="#addExistingObjectModal" role="button" class="btn" data-toggle="modal">Reference Object</a>

</div>
<br />
<div class="row-fluid">
  <div class="span12">
  <legend>Objects</legend>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu"
     style="display: block; position: static; margin-bottom: 5px; *width: 180px;">
  %if not objectList is None:
    %for object in objectList:
         <%
          if not foundObject:
              fistObjectID = object.identifier
              foundObject=True
          %>
      <li><a href="#" onclick="loadObject('${eventID}','${object.identifier}');">${object.definition.name}</a></li>
    %endfor
  %endif
   </ul>
  </div>
</div>

<script type="text/javascript">
value = $('#objectID').attr('value');
if (value == 'None') {
	loadObject(${eventID},${fistObjectID});
} else {
	loadObject(${eventID},value);
}
</script>



<%call expr="forms.genericModalForm(modalID='addObjectModal',url='/events/event/objects/attachObject',refreshUrl='/events/event/objects/objects/{0}'.format(eventID),refreshContainer='eventTabs{0}TabContent'.format(eventID))">
<%call expr="modals.objectModal(id='addObjectModal',title='Add object',contentUrl='/events/event/objects/addObject/{0}'.format(eventID))"/>
</%call>

