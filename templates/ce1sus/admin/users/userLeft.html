# -*- coding: utf-8 -*-



<%namespace name="modals" file="/dagr/components/modals.html"/>
<%namespace name="baseForms" file="/dagr/components/forms.html"/> 
<%namespace name="nav" file="/dagr/components/navigation.html"/> 

<div class="btn-group">
	<a href="#addUserModal" role="button" class="btn btn-default" data-toggle="modal">Add
		new User</a> 
	%if useLDAP:
	<a href="#addLDAPUserModal" role="button" class="btn btn-default"
		data-toggle="modal">Add LDAP User</a>
	%endif
</div>
<div style="height:15px"/>
<% 
foundUser=False 
fistUserID=0
selected = True
%>
<!--list of users -->
<script type="text/javascript">
function loadUser(userID){
	loadContent('userRight','/admin/users/rightContent?userid='+userID);
}
</script>

<div style="height: 800px;
   overflow: scroll;">
<ul class="nav nav-pills nav-stacked" style="max-width: 300px;">
	%if not users is None: 
		% for user in users:
		  <%call expr="nav.leftMenuItem(user.identifier, 'loadUser({0})'.format(user.identifier),user.username,selected)"/>
		  <%
		  if not foundUser:
		      fistUserID = user.identifier
		      foundUser=True
		      selected = False
		  %>
		% endfor 
	%endif
	
</ul>
</div>

<!-- AddUserForm -->
<%call expr="baseForms.genericModalForm(modalID='addUserModal',url='/admin/users/modifyUser',refreshUrl='/admin/users', refreshContainer='adminTabsTabContent')">
<input type="hidden" name="action" value="insert">
<%call expr="modals.saveButtonModal(id='addUserModal',title='Add User',contentUrl='/admin/users/addUser')"/>
</%call>

<!-- LdapUserTable -->
<%call expr="baseForms.genericModalForm(modalID='addLDAPUserModal',url='/admin/users/modifyUser',refreshUrl='/admin/users', refreshContainer='adminTabsTabContent')">
<%call expr="modals.genericModal('addLDAPUserModal', 'Add LDAP User', '/admin/users/ldapUsersTable', big=True)">
<input class="btn btn-primary" type="submit" value="Save changes"/>
</%call>
</%call>

<script type="text/javascript">
$(document).ready(function() {
	loadUser('${fistUserID}');
});
</script>