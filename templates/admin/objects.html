# -*- coding: utf-8 -*-

<%namespace name="baseComponents" file="/components/baseComponents.html"/>
<%namespace name="modals" file="/components/modals.html"/>
<%namespace name="forms" file="/components/forms.html"/>
<%inherit file="/layout/baselayout.html"/>


<ul class="nav nav-tabs">
    <li ><a href="/admin/users">Users</a></li>
    <li><a href="/admin/groups">Groups</a></li>
    <li class="active"><a href="#">Objects</a></li>
    <li><a href="/admin/attributes">Attributes</a></li>
</ul>
<div class="row-fluid">
    <div class="span4">
        <div class="btn-group">
            <a href="#addObjectModal" role="button" class="btn" data-toggle="modal">Add
                new Object</a>
            <form action="/admin/modifyObject" method="post">
                <input type="hidden" name="action" value="insert">
                <%call expr="modals.def_objectModal(id='addObjectModal',title='Add Object',object=None)"/> 
            </form>
        </div>
        <br />
        <!--list of objects -->
        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu"
            style="display: block; position: static; margin-bottom: 5px; *width: 180px;">
            %if not objects is None:
              % for object in objects:
                 <li><a tabindex="-1" href="/admin/objects/${object.identifier}">${object.name}</a></li> 
              % endfor
            %endif
        </ul>
    </div>
    <div class="span8">
           %if not errorMsg is None:
           <div class="alert alert-block alert-error fade in">
               <button type="button" class="close" data-dismiss="alert">x</button>
               <h4 class="alert-heading">An expected Error occurred!</h4>
               <p>${errorMsg}</p>
           </div>
           %endif
        <!-- object details -->
        <h3>Object details:</h3>
        
        <%call expr="forms.objectForm(objectDetails, False)"/>
                <div class="row-fluid">
        <div class="span3" style="text-align:right">
        % if not objectDetails is None:
        <div class="btn-group">
            <a href="#editObjectModal" role="button" class="btn"
                data-toggle="modal">Edit</a>
            <button class="btn btn-danger"
                onclick="if (confirm('Are you sure you want to delete?')) {location.href='/admin/modifyObject?identifier=${objectDetails.identifier}&action=remove'}">Delete</button>
        </div>
        <form action="/admin/modifyObject" method="post">
            %if action=='insert':
              <input type="hidden" name="action" value="insert">
              <%call expr="modals.def_objectModal(id='editObjectModal',title='Add Object',object=objectDetails,show=errors)"/> 
            %else:
              <input type="hidden" name="action" value="update">
              <%call expr="modals.def_objectModal(id='editObjectModal',title='Edit Object',object=objectDetails,show=errors)"/>
            %endif
        </form>
        % else:
            <div class="btn-group">
                <button class="btn">Edit</button>
                <button class="btn btn-danger">Delete</button>
            </div>
        %endif
            </div></div>
        <h4>Attributemanagment of this object:</h4>
        <form action="/admin/editObjectAttribute" method="post">
            % if not objectDetails is None:
            <input type="hidden" name="objID"
                value="${objectDetails.identifier}">
            %endif
            <table border="0" cellpadding="5">
                <tr>
                    <td>Attribtues not part of this object:<BR /> <select name="remainingAttributes"
                        size="10" multiple="multiple" tabindex="1"> 
                        %if not remainingAttributes is None:
                            % for attribute in remainingAttributes:
                                <option value="${attribute.identifier}">${attribute.name}</option> 
                            % endfor
                        %endif
                    </select>
                    </td>
                    <td>
                    % if not userDetails is None:
                        <button name="operation" class="btn" type="submit" value="remove">&lt;</button>
                        <BR />
                        <button name="operation" class="btn" type="submit" value="add">&gt;</button>
                    % else:
                        <div class="btn-group">
                            <button class="btn">&lt;</button><BR/>
                            <button class="btn">&gt;</button>
                        </div>
                    %endif
                    </td>
                    <td>Attribtues part of this object:<BR /> <select name="objectAttributes" size="10"
                        multiple> 
                        %if not objectAttributes is None:
                            % for attribute in objectAttributes:
                                <option value="${attribute.identifier}">${attribute.name}</option> 
                            % endfor
                        %endif
                    </select>
                    </td>
                </tr>
            </table>

        </form>
    </div>

</div>
