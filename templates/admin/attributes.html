<%namespace name="baseComponents" file="/components/baseComponents.html"/>
<%namespace name="modals" file="/components/modals.html"/>
<%namespace name="forms" file="/components/forms.html"/>
<%inherit file="/layout/baselayout.html"/>


<ul class="nav nav-tabs">
    <li><a href="/admin/users">Users</a></li>
    <li><a href="/admin/groups">Groups</a></li>
    <li><a href="/admin/objects">Objects</a></li>
    <li class="active" ><a href="#">Attributes</a></li>
</ul>
<div class="row-fluid">
    <div class="span4">
        <div class="btn-group">
            <a href="#addAttributeModal" role="button" class="btn" data-toggle="modal">Add
                new Attribute</a>
            <form action="/admin/modifyAttribute" method="post">
                <input type="hidden" name="action" value="insert">
                <%call expr="modals.def_attributeModal(id='addAttributeModal',title='Add Attribute',attribute=None,cbValues=cbValues)"/> 
            </form>
        </div>
        <br />
        <!--list of attributes -->
        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu"
            style="display: block; position: static; margin-bottom: 5px; *width: 180px;">
            %if not attributes is None:
              % for attribute in attributes:
                 <li><a tabindex="-1" href="/admin/attributes/${attribute.identifier}">${attribute.name}</a></li> 
              % endfor
            %endif
        </ul>
    </div>
    <div class="span8">
        %if not errorMsg is None:
           <div class="alert alert-block alert-error fade in">
               <button type="button" class="close" data-dismiss="alert">x</button>
               <h4 class="alert-heading">An expected Error occurred!</h4>
               <p>${errorMsg}</p>
           </div>
        %endif
        <!-- attribute details -->
        <h3>Attribute details:</h3>
        <%call expr="forms.attributeForm(attributeDetails, False,cbValues)"/>
                <div class="row-fluid">
        <div class="span3" style="text-align:right">
        % if not attributeDetails is None:
        <div class="btn-group">
            <a href="#editAttributeModal" role="button" class="btn"
                data-toggle="modal">Edit</a>
            <button class="btn btn-danger"
                onclick="if (confirm('Are you sure you want to delete?')) {location.href='/admin/modifyAttribute?identifier=${attributeDetails.identifier}&action=remove'}" >Delete</button>
        </div>
        <form action="/admin/modifyAttribute" method="post">
            %if action=='insert':
              <input type="hidden" name="action" value="insert">
              <%call expr="modals.def_attributeModal(id='editAttributeModal',title='Add Attribute',attribute=attributeDetails,show=errors,cbValues=cbValues)"/> 
            %else:
              <input type="hidden" name="action" value="update">
              <%call expr="modals.def_attributeModal(id='editAttributeModal',title='Edit Attribute',attribute=attributeDetails,show=errors,cbValues=cbValues)"/>
            %endif
        </form>
        % else:
            <div class="btn-group">
                <button class="btn">Edit</button>
                <button class="btn btn-danger">Delete</button>
            </div>
        %endif
            </div></div>
        <h4>Objectmanagment of this attribue:</h4>
        <form action="/admin/editAttributeObject" method="post">
            % if not attributeDetails is None:
            <input type="hidden" name="attrID"
                value="${attributeDetails.identifier}">
            %endif
            <table border="0" cellpadding="5">
                <tr>
                    <td>Objects not using this attribute:<BR /> <select name="remainingObjects"
                        size="10" multiple="multiple" tabindex="1"> 
                        %if not remainingObjects is None:
                            % for object in remainingObjects:
                                <option value="${object.identifier}">${object.name}</option> 
                            % endfor
                        %endif
                    </select>
                    </td>
                    <td>
                    % if not attributeDetails is None:
                        <button name="operation" class="btn" type="submit" value="remove">&lt;</button>
                        <BR />
                        <button name="operation" class="btn" type="submit" value="add">&gt;</button>
                    % else:
                        <div class="btn-group">
                            <button class="btn">&lt;</button><BR/>
                            <button class="btn">&gt;</button>
                        </div>
                    %endif
                    </td>
                    <td>Objects using this attribute:<BR /> <select name="attributeObjects" size="10"
                        multiple> 
                        %if not attributeObjects is None:
                            % for object in attributeObjects:
                                <option value="${object.identifier}">${object.name}</option> 
                            % endfor
                        %endif
                    </select>
                    </td>
                </tr>
            </table>

        </form>
    </div>

</div>
