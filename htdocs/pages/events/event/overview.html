
<legend>Details</legend>

<div class="row">
  <div class="col-xs-12 col-sm-12" style="text-align: left">
    <div class="btn-group" style="padding-bottom: 2px;">
      <button type="button" class="btn btn-default" ng-click="validateEvent()" ng-if="!event.properties.validated && event.userpermissions.validate">
      Validate
      </button>
      <button type="button" class="btn btn-default" data-template="pages/events/event/modals/edit.html" bs-modal="modal" ng-show="event.userpermissions.modify">
      Edit
      </button>
  
      <button ng-if="isAdmin" class="btn btn-warning" data-template="pages/events/event/modals/changeowner.html" bs-modal="modal">Change
        ownership</button>
      <button class="btn btn-danger" ng-click="removeEvent()" ng-show="event.userpermissions.delete">
        Delete</button>
      <button class="btn btn-primary" ng-click="publishEvent()" ng-show="event.userpermissions.modify && !event.published">
        Publish</button>
    </div>
   </div>

</div>
<div class="row">
  <div class="col-xs-12 col-sm-12" style="text-align: left">
    <div class="row">
      <div class="col-xs-6 col-md-6">
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Identifier: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">{{event.id_}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Title: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">{{event.stix_header.title}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Information Sources: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">
              {{event.stix_header.information_source.identity.name}} - {{getRolesName(event.stix_header.information_source.roles)}}
              <div ng-repeat="informationSource in event.stix_header.information_source.contributing_sources">
                <br>{{information_source.identity.name}} - {{information_source.roles}}
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Description: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left; overflow: auto; height: 125px">
              {{event.event.stix_header.description.value}}</div>
          </div>
        </div>
        
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Published: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">{{event.published}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Export: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <a href="/STIX/0.1/event/{{event.identifier}}?file">STIX XML</a>
            <a href="/MISP/0.1/event/{{event.identifier}}?file">MISP XML</a>
            <a href="/ce1sus/0.1/event/{{event.identifier}}?file&complete=true&inflated=true">ce1sus JSON</a>
          </div>
        </div>
      </div>
      <div class="col-xs-6 col-md-6">
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Status: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">{{event.status}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Analysis: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">{{event.analysis}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Risk: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">{{event.risk}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> TLP: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">{{event.tlp}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Created: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">
              {{event.created_at}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Modified: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">
              {{event.modified_on}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> First seen: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">
              {{event.first_seen}}</div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-3"
            style="text-align: right; padding: 3px; padding-left: 15px">
            <label> Last seen: </label>
          </div>
          <div class="col-xs-9" style="padding: 3px; padding-left: 15px">
            <div style="text-align: left;">
              {{event.last_seen}}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div ng_show="relations.length > 0">
  <legend>Relations</legend>
  <table class="table table-striped table-bordered table-hover table-condensed">
    <tr>
      <td>
        Event Title
      </td>
      <td>
        Options
      </td>
    </tr>
    <tr  ng-repeat="relation in relations | startFrom: pagination.page * pagination.perPage | limitTo: pagination.perPage">
      <td>{{relation.title}}</td>
      <td><a href="" ng-click="pushItem(relation, true)"><span class="glyphicon glyphicon-eye-open" title="View event" ></span></a></td>
    </tr>
  </table>
  <ul class="pagination" ng-if="1 < pagination.numPages">
    <li ng-class="{ disabled : pagination.page == 0 }">
      <a href="" ng-click="pagination.toPageId(0)">&laquo;</a>
    </li>
    <li ng-class="{ disabled : pagination.page == 0 }">
      <a href="" ng-click="pagination.prevPage()">&lsaquo;</a>
    </li>
    <li ng-repeat="pageNumber in pagination.pages track by $index" ng-class="{ active : pageNumber-1 == pagination.page, disabled : pageNumber == '...' }">
      <a href="" ng-click="pagination.toPageId(pageNumber-1)">{{ pageNumber }}</a>
    </li>
    <li ng-class="{ disabled : pagination.page == pagination.numPages-1}">
      <a href="" ng-click="pagination.nextPage()">&rsaquo;</a>
    </li>
    <li ng-class="{ disabled : pagination.page == pagination.numPages-1 }">
      <a href="" ng-click="pagination.toPageId(pagination.numPages-1)">&raquo;</a>
    </li>
  </ul>
</div>
<div ng-show="event.userpermissions.owner">
  <legend>Comments</legend>
  <table class="table table-striped table-hover table-condensed">
    <thead>
      <tr>
        <th>Comment</th>
        <th>Date</th>
        <th width="150px">Options</th>
      </tr>
    </thead>
      <tbody>
        <tr ng-repeat="comment in event.comments">
          <td>{{comment.comment}}</td>
          <td>{{comment.created_at}}</td>
          <td>
            <a class="hand" ng-click="showCommentDetails(comment)"><span class="glyphicon glyphicon-eye-open"></span></a>
            <a class="hand" ng-click="editCommentDetails(comment)"><span class="glyphicon glyphicon-pencil"></span></a>
            <a class="hand red" ng-click="removeComment(comment)"><span class="glyphicon glyphicon-remove-circle"></span></a>
          </td>
        </tr>
      </tbody>
  </table>
  <div class="btn-group">
    <button type="button" class="btn btn-default" data-template="pages/events/event/modals/addcomment.html" bs-modal="modal">Add new
      Comment
    </button>
  </div>
</div>